{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load static %}

{% block content %}
<div class="container">
    <div class="row">

        <h3 class="col-12 mb-4"><span class="lead">{{ tool.name }}</span></h3>
        <div class="col">
            <h4>Prompt template
                <a href="{% url 'admin:llmtools_tool_change' tool.id %}" class="btn btn-outline-success btn-sm pl-4">Edit</a>
            </h4>

            <p class="small">
                Tool prompts are templates to combine inputs and instructions to the LLM.
                For file-based jobs, only one placeholder is required/allowed, called <code>{% verbatim %}{{source}}{% endverbatim %}</code>.
                For details of permitted instructions, see mindframe docs.
                For data extraction use <code>[[extract:varname]]</code> and for other instructions use <code>[[respond:varname]]</code>. Specifying a varname is optional. Other response types are <code>speak, think, number/int, pick/decide, boolean/bool</code> and <code>poem</code>.

            </p>


            <hr>



            <code style="white-space: pre-wrap;">
{{tool.prompt|safe}}
            </code>
        </div>

        <div class="col">
            <h4>Inputs</h4>

            <p class="small">
                Each placeholder in the prompt is a variable that can be filled in with a value. To test the prompt, fill in the values for each variable and click Submit.
                For file-based batch jobs, the contents of the file are extracted as text and used to fill the <code>{% verbatim %}{{source}}{% endverbatim %}</code> placeholder.
            </p>
                        <form method="POST" type="multipart/form-data" enctype="multipart/form-data">
                {% csrf_token %}
                {{ form|crispy }}
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        </div>

        <div class="col">

            {% if results %}
            <h4>Results for <code> {{ tool.name }}</code></h4>
                <pre style="white-space: pre-wrap;">
{{results}}
                </pre>
                <pre style="white-space: pre-wrap;">
{{ results.response }}
                </pre>
            <hr>
            {% else %}
            <h4>Results </h4>
            {% endif %}

        </div>


    </div>
</div>
{% endblock %}
